CREATE DB PINOFY;

CREATE TABLE ALBUM (
	CodA SERIAL,
	Titolo VARCHAR(30) NOT NULL,
	AnnoU INTEGER,
	Durata DOUBBLE,
	Ntracce INTEGER,
	Etichetta VARCHAR(20) DEFAULT NULL,
	Voto INTEGER DEFAULT 0,
	
	PRIMARY KEY (CodA)
);


CREATE TABLE TRACCIA (
	CodT SERIAL,
	Titolo VARCHAR(20) NOT NULL, --MANCA NEL LOGICO--
	Durata DOUBBLE,
	Etichetta VARCHAR(20) DEFAULT NULL,
	AnnoU INTEGER,
	IsCover BOOLEAN,
	IsRemastered BOOLEAN,
	Genere VARCHAR(20),
	Link VARCHAR(100),
	Formato VARCHAR(20), --NON SONO SICURO--
	Voto INTEGER DEFAULT 0,
	Qualita INTEGER,
	CodA INTEGER,
	
	
	PRIMARY KEY (CodT),
	FOREIGN KEY (CodA) REFERENCES Album(CodA)
	
);


CREATE TABLE UTENTE (
	NickName VARCHAR(20),
	Email VARCHAR(25), -- farei un create domain prima per la mail
	Password VARCHAR(10),
	DataN DATE,
	Sesso VARCHAR(15) DEFAULT NULL,
	Nazionalita VARCHAR(15) DEFAULT NULL,
	Descrizione VARCHAR(100) DEFAULT NULL,
	IsPremium BOOLEAN,
	IsAdmin BOOLEAN,

	PRIMARY KEY (NickName)

);


CREATE TABLE PLAYLIST(
	CodP SERIAL,
	Titolo VARCHAR(20),
	Durata DOUBBLE,
	NTracce, INTEGER,
	Visibilita BOOLEAN,
	NickName VARCHAR(20),
	
	PRIMARY KEY (CodP),
	FOREIGN KEY (NickName) REFERENCES UTENTE(NickName)
);


CREATE TABLE ASCOLTA (
	Nickname VARCHAR(20),
	CodT INTEGER,
	FasciaOraria INTEGER,
	
	FOREIGN KEY (NickName) REFERENCES UTENTE(NickName),
	FOREIGN KEY (CodT) REFERENCES TRACCIA(CodT)
	
	
	);

CREATE TABLE VOTA (
	NickName VARCHAR(20),
	CodT INTEGER,
	Voto INTEGER,
	FOREIGN KEY (NickName) REFERENCES UTENTE(NickName),
	FOREIGN KEY (CodT) REFERENCES TRACCIA(CodT)		

);


CREATE TABLE CONTIENE (
	CodP INTEGER,
	CodT INTEGER,

	FOREIGN KEY (CodT) REFERENCES TRACCIA(CodT),
	FOREIGN KEY (CodP) REFERENCES PLAYLIST(CodP)
	
);


CREATE TABLE ARTISTA (
	NomeArte VARCHAR(20),
	Descrizione VARCHAR(20) DEFAULT NULL,
	Voto INTEGER,

	PRIMARY KEY(NomeArte)

);

CREATE TABLE INCIDE (
	NomeArte VARCHAR(20),
	CodA INTEGER,
	
	FOREIGN KEY (NomeArte) REFERENCES ARTISTA(NomeArte),
	FOREIGN KEY (CodA) REFERENCES ALBUM(CodA)


);

CREATE TABLE PRODUCE (
	NomeArte VARCHAR(20),
	CodT INTEGER,
	
	FOREIGN KEY (NomeArte) REFERENCES ARTISTA(NomeArte),
	FOREIGN KEY (CodT) REFERENCES TRACCIA(CodT)
);



